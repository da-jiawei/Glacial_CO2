filter_g = function(data, age_column) {
  glacial_age_ranges = tibble::tibble(
    start = c(0.014, 0.057, 0.13, 0.243, 0.337, 0.424, 0.533, 0.621, 0.712, 
              0.79, 0.866, 0.917, 0.959, 0.982, 1.031, 1.081, 1.114, 1.19, 
              1.244, 1.286, 1.32, 1.362, 1.405, 1.452, 1.492, 1.53, 1.57, 
              1.608, 1.6425, 1.6975, 1.743, 1.782, 1.816, 1.8325, 1.8595, 
              1.898, 1.941, 1.99, 2.043, 2.103, 2.146, 2.192, 2.236, 2.273, 
              2.309, 2.35, 2.387, 2.427, 2.477, 2.51, 2.554),
    end   = c(0.029, 0.071, 0.191, 0.3, 0.374, 0.478, 0.563, 0.676, 0.761, 
              0.814, 0.9, 0.936, 0.97, 1.014, 1.062, 1.104, 1.141, 1.215, 
              1.264, 1.304, 1.344, 1.383, 1.424, 1.469, 1.51, 1.5475, 1.585, 
              1.6285, 1.67, 1.715, 1.758, 1.8025, 1.826, 1.849, 1.875, 1.915, 
              1.965, 2.017, 2.088, 2.125, 2.168, 2.2075, 2.25, 2.291, 2.333, 
              2.373, 2.407, 2.452, 2.494, 2.54, 2.575)
  )
  data %>%
    mutate(age = !!sym(age_column) / 1000) %>%
    filter(
      purrr::map_lgl(age, ~ any(. >= glacial_age_ranges$start & . <= glacial_age_ranges$end))
    )
}

filter_ig = function(data, age_column) {
  interglacial_age_ranges = tibble::tibble(
    start = c(0, 0.029, 0.071, 0.191, 0.3, 0.374, 0.478, 0.563, 0.676, 
              0.761, 0.814, 0.9, 0.936, 0.97, 1.014, 1.062, 1.104, 1.141, 
              1.215, 1.264, 1.304, 1.344, 1.383, 1.424, 1.469, 1.51, 1.5475, 
              1.585, 1.6285, 1.67, 1.715, 1.758, 1.8025, 1.826, 1.849, 1.875, 
              1.915, 1.965, 2.017, 2.088, 2.125, 2.168, 2.2075, 2.25, 2.291, 
              2.333, 2.373, 2.407, 2.452, 2.494, 2.54, 2.575),
    end   = c(0.014, 0.057, 0.13, 0.243, 0.337, 0.424, 0.533, 0.621, 0.712, 
              0.79, 0.866, 0.917, 0.959, 0.982, 1.031, 1.081, 1.114, 1.19, 
              1.244, 1.286, 1.32, 1.362, 1.405, 1.452, 1.492, 1.53, 1.57, 
              1.608, 1.6425, 1.6975, 1.743, 1.782, 1.816, 1.8325, 1.8595, 
              1.898, 1.941, 1.99, 2.043, 2.103, 2.146, 2.192, 2.236, 2.273, 
              2.309, 2.35, 2.387, 2.427, 2.477, 2.51, 2.554, 2.595)
  )
  data %>%
    mutate(age = !!sym(age_column) / 1000) %>%
    filter(
      purrr::map_lgl(age, ~ any(. >= interglacial_age_ranges$start & . <= interglacial_age_ranges$end))
    )
}

# assign binned time groups
assign_time_group = function(age, interval, age_max) {
  breaks = seq(0, age_max, by = interval)
  labels = paste0(
    sprintf("%.1f", breaks[-length(breaks)] + interval), "-", 
    sprintf("%.1f", breaks[-length(breaks)]), " Ma"
  )
  
  cut(age, breaks, labels = labels, right = FALSE)
}
